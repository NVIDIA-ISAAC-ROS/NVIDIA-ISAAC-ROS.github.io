Tutorial for Bi3D with Isaac Sim
================================

.. figure:: :ir_lfs:`<resources/isaac_ros_docs/concepts/stereo_depth/bi3d/bi3d_isaac_sim_rviz.png>`
   :align: center
   :width: 600px

Overview
------------

This tutorial walks through setting up a graph to 
:ir_repo:`segment stereo image pairs <isaac_ros_depth_segmentation>`
generated by Isaac Sim by depth disparity levels. For more details on
the output please refer to the 
:ref:`interpreting the output <bi3d interpreting the output>` section of the package reference.

Tutorial Walkthrough
--------------------

1. Complete steps 1-7 listed in the 
   :ref:`Quickstart section <repositories_and_packages/isaac_ros_depth_segmentation/isaac_ros_bi3d/index:quickstart>` of the package reference.

2. Install and launch Isaac Sim following the steps in the :doc:`Isaac ROS Isaac Sim Setup Guide </getting_started/isaac_sim/index>`

3. Press **Play** to start publishing data from the Isaac Sim

    .. figure:: :ir_lfs:`<resources/isaac_ros_docs/getting_started/isaac_sim_sample_scene.png>`
        :align: center
        :width: 600px

4. Open a second terminal and attach to the container:

   .. code:: bash

      cd ~/workspaces/isaac_ros-dev/src/isaac_ros_common && \
      ./scripts/run_dev.sh

5. In the second terminal, start the ``isaac_ros_bi3d`` node using the
   launch files:

   .. code:: bash

      ros2 launch isaac_ros_bi3d isaac_ros_bi3d_isaac_sim.launch.py \
      featnet_engine_file_path:=/tmp/models/bi3d/bi3dnet_featnet.plan \
      segnet_engine_file_path:=/tmp/models/bi3d/bi3dnet_segnet.plan 

   You should see a RViz window, as shown at the top of this page.

6. Optionally, you can run the visualizer script to visualize the
   disparity image.

   .. code:: bash

      ros2 run isaac_ros_bi3d isaac_ros_bi3d_visualizer.py

   .. figure:: :ir_lfs:`<resources/isaac_ros_docs/concepts/stereo_depth/bi3d/Visualizer_isaac_sim.png>`
      :align: center
      :width: 600px
